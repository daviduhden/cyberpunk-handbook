<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Linux Hardening</title>
    <link rel="icon" href="./../favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="./../styles.css">
</head>

<body>
    <header>
        <h1>Linux Hardening</h1>
    </header>

    <nav>
        <ul>
            <li><a href="./../index.html" target="_blank" rel="noopener noreferrer">Home</a></li>
            <li><a href="./../manifesto.html" target="_blank" rel="noopener noreferrer">Manifesto</a></li>
            <li><a href="./../contact.html" target="_blank" rel="noopener noreferrer">Contact</a></li>
        </ul>
    </nav>
    <main>
        <section id="table-of-contents" class="guides">
            <h2>Table of Contents</h2>
            <ul>
                <li><a href="#physical-security">1. Physical Security</a>
                    <ul>
                        <li><a href="#disk-encryption">1.1 Disk Encryption</a></li>
                        <li><a href="#encrypt-external-storage">1.2 Encrypt External Storage</a></li>
                        <li><a href="#prevent-rogue-usb-attacks">1.3 Prevent Rogue USB Attacks</a></li>
                        <li><a href="#dma-attack-protection">1.4 DMA Attack Protection</a></li>
                        <li><a href="#automounting">1.5 Automounting</a></li>
                        <li><a href="#bootloader-password">1.6 Bootloader Password</a></li>
                        <li><a href="#display-security-account-lockdown">1.7 Display Security and Account Lock Down</a>
                        </li>
                    </ul>
                </li>
                <li><a href="#securing-root">2. Securing Root</a>
                    <ul>
                        <li><a href="#mitigate-keylogger-threats">2.1 Mitigate Keylogger Threats</a></li>
                        <li><a href="#create-non-wheel-user">2.2 Create Non-Wheel User</a></li>
                        <li><a href="#remove-suid-sudo">2.3 Remove SUID and Sudo</a></li>
                        <li><a href="#restrict-root-access">2.4 Restrict Root Access</a></li>
                        <li><a href="#allow-non-wheel-users-usbguard">2.5 Allow Non-Wheel Users to Use USBGuard</a></li>
                    </ul>
                </li>
                <li><a href="#kernel-hardening">3. Kernel Hardening</a>
                    <ul>
                        <li><a href="#bootloader-parameter-hardening">3.1 Bootloader Parameter Hardening</a></li>
                        <li><a href="#linux-kernel-runtime-guard">3.2 Linux Kernel Runtime Guard (LKRG)</a></li>
                        <li><a href="#hardened-malloc">3.3 Hardened Malloc</a></li>
                        <li><a href="#linux-hardened-kernel">3.4 Linux-Hardened Kernel</a></li>
                        <li><a href="#kernel-module-blacklisting">3.5 Kernel Module Blacklisting</a></li>
                        <li><a href="#sysctl-hardening">3.6 Sysctl Hardening</a></li>
                    </ul>
                </li>
                <li><a href="#attack-surface-reduction">4. Attack Surface Reduction</a></li>
                <li><a href="#software-security">5. Security and Authenticity of Software Updates</a></li>
                <li><a href="#network-security">6. Network Security</a></li>
            </ul>
        </section>
        <section id="physical-security">
            <h2>1. Physical Security</h2>
            <p>This section provides practical, step-by-step instructions to implement physical security measures on
                your
                Linux system. Follow these guidelines to protect your hardware and data from physical attacks and
                unauthorized access.</p>

            <section id="disk-encryption">
                <h3>1.1 Disk Encryption</h3>
                <p>Encrypting your disk ensures that your data remains protected even if the hardware is stolen or
                    accessed
                    by unauthorized users. Follow these steps to set up full disk encryption using LUKS:</p>
                <ol>
                    <li><strong>Install cryptsetup:</strong> Open a terminal and install the cryptsetup package. For
                        example, on Debian/Ubuntu systems, run:
                        <pre>sudo apt-get install cryptsetup</pre>
                    </li>
                    <li><strong>Backup Data:</strong> Before making any changes, back up your data. Disk encryption will
                        reformat your partition.</li>
                    <li><strong>Initialize LUKS on the Partition:</strong> Replace <code>/dev/sdX</code> with your
                        actual
                        device name:
                        <pre>sudo cryptsetup luksFormat /dev/sdX</pre>
                    </li>
                    <li><strong>Open the Encrypted Partition:</strong>
                        <pre>sudo cryptsetup luksOpen /dev/sdX my_encrypted_drive</pre>
                    </li>
                    <li><strong>Create a Filesystem:</strong> Format the unlocked device:
                        <pre>sudo mkfs.ext4 /dev/mapper/my_encrypted_drive</pre>
                    </li>
                    <li><strong>Mount the Filesystem:</strong>
                        <pre>sudo mount /dev/mapper/my_encrypted_drive /mnt</pre>
                    </li>
                    <li><strong>Configure Auto-Mounting at Boot:</strong> Edit your <code>/etc/crypttab</code> and
                        <code>/etc/fstab</code> files to add the encrypted partition so it unlocks automatically (with
                        caution and proper security considerations).
                    </li>
                    <li><strong>Use Strong Passphrases:</strong> When prompted for a passphrase, choose a long and
                        complex
                        password. Consider using a passphrase manager or multi-factor authentication if available.</li>
                </ol>
            </section>

            <section id="encrypt-external-storage">
                <h3>1.2 Encrypt External Storage</h3>
                <p>If you choose not to encrypt external storage by default, it is important to understand when
                    encryption
                    is necessary. If you are transferring sensitive data or if the device may be lost or stolen, encrypt
                    it
                    by following these steps:</p>
                <ol>
                    <li><strong>Select Encryption Software:</strong> Options include VeraCrypt, LUKS (for Linux), or
                        BitLocker (on Windows for cross-platform use). For Linux, you can use LUKS similarly to disk
                        encryption.</li>
                    <li><strong>Install and Configure the Tool:</strong> For LUKS encryption on an external USB drive:
                        <pre>sudo cryptsetup luksFormat /dev/sdY</pre>
                        Replace <code>/dev/sdY</code> with your external drive's identifier.
                    </li>
                    <li><strong>Open and Format the Device:</strong>
                        <pre>sudo cryptsetup luksOpen /dev/sdY my_usb
sudo mkfs.ext4 /dev/mapper/my_usb</pre>
                    </li>
                    <li><strong>Mount the Encrypted Volume:</strong>
                        <pre>sudo mount /dev/mapper/my_usb /mnt</pre>
                    </li>
                    <li><strong>Remember the Passphrase:</strong> Document your passphrase securely and consider
                        additional
                        authentication mechanisms if available.</li>
                </ol>
                <p>If external encryption is not enabled, ensure physical control and restrict the use of external
                    devices
                    to minimize risk.</p>
            </section>

            <section id="prevent-rogue-usb-attacks">
                <h3>1.3 Prevent Rogue USB Attacks</h3>
                <p>To defend against unauthorized USB devices, follow these steps:</p>
                <ol>
                    <li><strong>Disable Unused USB Ports:</strong> Access your BIOS/UEFI settings during system boot
                        (usually by pressing F2, DEL, or ESC) and disable unused USB ports.</li>
                    <li><strong>Configure the Operating System:</strong>
                        <ul>
                            <li>For Linux, create udev rules to block unauthorized devices. For example, create a file
                                <code>/etc/udev/rules.d/90-usbblock.rules</code> with contents similar to:
                                <pre>SUBSYSTEM=="usb", ATTR{authorized}="0"</pre>
                            </li>
                            <li>You can also use tools like USBGuard to monitor and control USB device access. Install
                                it
                                with:
                                <pre>sudo apt-get install usbguard</pre>
                                and then configure the policy according to your needs.
                            </li>
                        </ul>
                    </li>
                    <li><strong>Establish User Policies:</strong> Educate users about the risks of connecting unknown
                        USB
                        devices and enforce policies restricting their use.</li>
                </ol>
            </section>

            <section id="dma-attack-protection">
                <h3>1.4 DMA Attack Protection</h3>
                <p>DMA attacks exploit direct memory access to bypass security measures. Protect your system by:</p>
                <ol>
                    <li><strong>Enable IOMMU:</strong> Many systems support an Input-Output Memory Management Unit
                        (IOMMU)
                        that isolates device memory access. To enable it:
                        <ul>
                            <li>For Intel systems, add <code>intel_iommu=on</code> to your boot loader configuration
                                (GRUB).
                                Edit <code>/etc/default/grub</code>:
                                <pre>GRUB_CMDLINE_LINUX="intel_iommu=on"</pre>
                                Then update GRUB:
                                <pre>sudo update-grub</pre>
                            </li>
                            <li>For AMD systems, use <code>amd_iommu=on</code> instead.</li>
                        </ul>
                    </li>
                    <li><strong>Disable Unused Ports:</strong> Disable or physically block unused ports that might
                        support
                        DMA, such as Thunderbolt, when not in use.</li>
                    <li><strong>Secure BIOS/UEFI Settings:</strong> Set a BIOS/UEFI password and disable booting from
                        external devices to prevent unauthorized configuration changes.</li>
                </ol>
            </section>

            <section id="automounting">
                <h3>1.5 Automounting</h3>
                <p>Automatic mounting of external media can introduce security vulnerabilities. Follow these steps to
                    control automounting:</p>
                <ol>
                    <li><strong>Disable Automount in Desktop Environments:</strong>
                        <ul>
                            <li>For GNOME, open Settings, navigate to <em>Removable Media</em>, and disable automount.
                            </li>
                            <li>For KDE, go to System Settings, then <em>Removable Storage</em>, and uncheck options for
                                automounting.</li>
                        </ul>
                    </li>
                    <li><strong>Manually Mount Devices:</strong> Instead of automounting, use the terminal to mount
                        devices:
                        <pre>sudo mount /dev/sdZ /mnt</pre>
                        Replace <code>/dev/sdZ</code> with the actual device identifier.
                    </li>
                    <li><strong>Review and Update Policies:</strong> Regularly audit your automount configurations and
                        ensure that any new device policies are secure.</li>
                </ol>
            </section>

            <section id="bootloader-password">
                <h3>1.6 Bootloader Password</h3>
                <p>Securing the bootloader prevents unauthorized changes to boot configurations. Here’s how to set a
                    password in GRUB:</p>
                <ol>
                    <li><strong>Generate a Password Hash:</strong> Use the <code>grub-mkpasswd-pbkdf2</code> command to
                        generate a hashed password:
                        <pre>grub-mkpasswd-pbkdf2</pre>
                        Copy the generated hash.
                    </li>
                    <li><strong>Edit GRUB Configuration:</strong> Open or create the file
                        <code>/etc/grub.d/40_custom</code>
                        and add the following lines:
                        <pre>
set superusers="admin"
password_pbkdf2 admin [generated-hash]</pre>
                        Replace <code>[generated-hash]</code> with your copied hash.
                    </li>
                    <li><strong>Update GRUB:</strong> Run:
                        <pre>sudo update-grub</pre>
                    </li>
                    <li><strong>Lock BIOS/UEFI:</strong> Enter BIOS/UEFI settings during boot, set a strong
                        administrator
                        password, and restrict changes to boot order and firmware settings.</li>
                </ol>
            </section>

            <section id="display-security-account-lockdown">
                <h3>1.7 Display Security and Account Lock Down</h3>
                <p>Ensure that your system locks automatically when unattended and that account access is properly
                    managed:
                </p>
                <ol>
                    <li><strong>Configure a Screen Lock:</strong>
                        <ul>
                            <li>In GNOME, navigate to Settings &gt; Privacy &gt; Screen Lock and set a short timeout
                                period.
                            </li>
                            <li>In KDE, go to System Settings &gt; Workspace Behavior &gt; Screen Locking to configure
                                lock
                                settings.</li>
                        </ul>
                    </li>
                    <li><strong>Implement Session Management Policies:</strong> Configure your desktop environment to
                        require a password upon wake-up or when switching users.</li>
                    <li><strong>Set Account Lockout Parameters:</strong> Edit the Pluggable Authentication Module (PAM)
                        configuration (for example, in <code>/etc/pam.d/common-auth</code> on Debian/Ubuntu) to limit
                        the
                        number of failed login attempts. A common configuration is to use the <code>pam_tally2</code> or
                        <code>pam_faillock</code> modules.
                    </li>
                    <li><strong>Educate Users:</strong> Ensure that users understand the importance of locking their
                        screens
                        when stepping away from the computer.</li>
                </ol>
            </section>
        </section>

        <section id="securing-root">
            <h2>2. Securing Root</h2>
            <p>Securing root privileges is crucial for protecting your Linux system against unauthorized administrative
                access. The following guidelines provide step-by-step instructions to mitigate keylogger threats,
                enforce strict user privilege policies, and reduce the risk of privilege escalation.</p>

            <section id="mitigate-keylogger-threats">
                <h3>2.1 Mitigate Keylogger Threats</h3>
                <p>Keyloggers can capture sensitive keystrokes and expose passwords or confidential data. Implement
                    these measures to protect your system:</p>
                <ol>
                    <li>
                        <strong>Use Virtual Keyboards:</strong>
                        <p>When entering sensitive information such as passwords, consider using an on-screen keyboard.
                            Many desktop environments (e.g., GNOME or KDE) provide a built-in virtual keyboard that
                            minimizes hardware keylogger risks.</p>
                    </li>
                    <li>
                        <strong>Install Anti-Keylogger Software:</strong>
                        <p>Detect potential keylogger activity by installing security tools such as
                            <code>rkhunter</code> or <code>chkrootkit</code>. Run periodic scans to detect malicious
                            processes or unauthorized modifications.
                        </p>
                    </li>
                    <li>
                        <strong>Regularly Update Software:</strong>
                        <p>Keep your operating system and applications updated to ensure that known vulnerabilities and
                            exploits (including those targeting keyloggers) are patched.</p>
                    </li>
                    <li>
                        <strong>Monitor System Processes:</strong>
                        <p>Use system monitoring tools (like <code>top</code>, <code>htop</code>, or <code>ps</code>) to
                            regularly review running processes. Any unexpected or unfamiliar process should be
                            investigated.</p>
                    </li>
                </ol>
            </section>

            <section id="create-non-wheel-user">
                <h3>2.2 Create Non-Wheel User</h3>
                <p>Limiting direct root access by using non-privileged accounts can reduce the risk of accidental or
                    malicious system modifications. Follow these steps:</p>
                <ol>
                    <li>
                        <strong>Add a New User:</strong>
                        <p>Create a standard user account that does not have administrative (wheel) privileges:</p>
                        <pre>sudo adduser newuser</pre>
                    </li>
                    <li>
                        <strong>Verify Group Membership:</strong>
                        <p>Ensure that the new user is not part of the wheel group, which is often granted sudo
                            privileges:</p>
                        <pre>sudo gpasswd -d newuser wheel</pre>
                    </li>
                    <li>
                        <strong>Assign Minimal Privileges:</strong>
                        <p>Configure the user account with the minimum permissions required for daily tasks, and only
                            grant sudo rights when absolutely necessary via the sudoers file.</p>
                    </li>
                </ol>
            </section>

            <section id="remove-suid-sudo">
                <h3>2.3 Remove SUID and Sudo</h3>
                <p>Files with the SUID bit set or misconfigured sudo privileges can be exploited for privilege
                    escalation. Follow these steps to review and restrict them:</p>
                <ol>
                    <li>
                        <strong>Identify SUID Files:</strong>
                        <p>Run a scan to locate files with SUID permissions:</p>
                        <pre>find / -perm /4000 -type f 2>/dev/null</pre>
                    </li>
                    <li>
                        <strong>Remove the SUID Bit When Not Needed:</strong>
                        <p>If a file does not require SUID permissions, remove them using:</p>
                        <pre>sudo chmod u-s /path/to/file</pre>
                    </li>
                    <li>
                        <strong>Restrict Sudo Access:</strong>
                        <p>Edit the sudoers file to limit administrative privileges. Use the <code>visudo</code> command
                            to safely modify the file, and remove or restrict entries that grant broad sudo rights.</p>
                        <pre>sudo visudo</pre>
                    </li>
                </ol>
                <p>Regular audits and careful configuration can help prevent unauthorized privilege escalation.</p>
            </section>

            <section id="restrict-root-access">
                <h3>2.4 Restrict Root Access</h3>
                <p>Preventing direct root login reduces the system's exposure to brute-force attacks and unauthorized
                    changes. Implement these steps:</p>
                <ol>
                    <li>
                        <strong>Disable Root SSH Login:</strong>
                        <p>Edit the SSH configuration file to disallow root logins:</p>
                        <pre>sudo nano /etc/ssh/sshd_config</pre>
                        <p>Locate the line containing <code>PermitRootLogin</code> and set it to <code>no</code>. Save
                            your changes and restart the SSH service:</p>
                        <pre>sudo systemctl restart sshd</pre>
                    </li>
                    <li>
                        <strong>Use Sudo for Administrative Tasks:</strong>
                        <p>Encourage users to perform administrative actions using <code>sudo</code> instead of logging
                            in as root. This approach provides an audit trail and minimizes exposure.</p>
                    </li>
                    <li>
                        <strong>Enforce Strong Authentication:</strong>
                        <p>Ensure that all administrative accounts use strong passwords or multi-factor authentication
                            (MFA) when available.</p>
                    </li>
                </ol>
            </section>

            <section id="allow-non-wheel-users-usbguard">
                <h3>2.5 Allow Non-Wheel Users to Use USBGuard</h3>
                <p>To prevent unauthorized USB access while still allowing limited user control, configure USBGuard for
                    non-wheel users:</p>
                <ol>
                    <li>
                        <strong>Install USBGuard:</strong>
                        <p>If not already installed, add USBGuard to your system using your package manager. For
                            example, on Debian-based systems:</p>
                        <pre>sudo apt-get install usbguard</pre>
                    </li>
                    <li>
                        <strong>Configure User Permissions:</strong>
                        <p>Edit the USBGuard daemon configuration file to allow specific non-wheel users to manage USB
                            policies:</p>
                        <pre>sudo nano /etc/usbguard/usbguard-daemon.conf</pre>
                        <p>Add or modify the line to include your chosen username:</p>
                        <pre>IPCAllowedUsers=nonwheeluser</pre>
                        <p>Replace <code>nonwheeluser</code> with the actual username. Save and restart the USBGuard
                            service:</p>
                        <pre>sudo systemctl restart usbguard</pre>
                    </li>
                    <li>
                        <strong>Test Configuration:</strong>
                        <p>Ensure that the specified non-wheel user can interact with USBGuard as intended by checking
                            the logs and performing test actions.</p>
                    </li>
                </ol>
            </section>
        </section>

        <section id="kernel-hardening">
            <h2>3. Kernel Hardening</h2>

            <section id="bootloader-parameter-hardening">
                <h3>3.1 Bootloader Parameter Hardening</h3>
                <p>
                    Securing bootloader parameters is a critical step in hardening your Linux system. These parameters
                    enforce strict memory initialization, randomization, and disable legacy or vulnerable
                    features—thereby reducing the kernel's attack surface.
                </p>
                <p>
                    Below is an example of a <strong>stable</strong> set of bootloader parameters:
                </p>
                <pre>GRUB_CMDLINE_LINUX="init_on_alloc=1 init_on_free=1 slab_nomerge page_alloc.shuffle=1 randomize_kstack_offset=on vsyscall=none lockdown=confidentiality random.trust_cpu=off random.trust_bootloader=off iommu=force intel_iommu=on amd_iommu=force_isolation iommu.passthrough=0 iommu.strict=1 pti=on module.sig_enforce=1 mitigations=auto,nosmt spectre_v2=on spec_store_bypass_disable=on l1d_flush=on l1tf=full,force kvm-intel.vmentry_l1d_flush=always"</pre>
                <p>
                    You can extend this base with <strong>additional</strong> parameters for further security:
                </p>
                <ul>
                    <li><code>ia32_emulation=0</code> — Disables 32-bit processes and syscalls.</li>
                    <li><code>nosmt=force</code> — Force-disables simultaneous multithreading (SMT), regardless of
                        vulnerability status.</li>
                </ul>
                <p>
                    Optionally, if you wish to push hardening even further (with some risk of instability), you can add
                    these <strong>unstable</strong> parameters:
                </p>
                <ul>
                    <li><code>efi=disable_early_pci_dma</code> — Mitigates early PCI DMA risks by filling IOMMU
                        protection gaps.</li>
                    <li><code>debugfs=off</code> — Disables debugfs to prevent exposure of sensitive kernel data.</li>
                    <li><code>gather_data_sampling=force</code> — Mitigates unprivileged speculative data access, or
                        disables AVX on vulnerable systems.</li>
                </ul>
                <p>
                    <strong>To apply these changes:</strong>
                </p>
                <ol>
                    <li>
                        Edit the GRUB configuration file:
                        <pre>sudo nano /etc/default/grub</pre>
                    </li>
                    <li>
                        Replace or modify the <code>GRUB_CMDLINE_LINUX</code> line with your chosen set of parameters.
                    </li>
                    <li>
                        Update GRUB to apply the new configuration:
                        <pre>sudo update-grub</pre>
                    </li>
                </ol>
                <p>
                    These bootloader parameters help ensure that your system boots with enhanced security measures,
                    including strict memory management, robust DMA protection, and enforced module integrity.
                </p>
            </section>

            <section id="linux-kernel-runtime-guard">
                <h3>3.2 Linux Kernel Runtime Guard (LKRG)</h3>
                <p>
                    LKRG performs runtime integrity checking of the Linux kernel to detect and respond to security
                    exploits. It is implemented as a kernel module (not a patch) and supports a wide range of kernel
                    versions and CPU architectures. The following instructions cover obtaining the sources, building,
                    testing, installing, and configuring LKRG.
                </p>

                <h4>Getting the Sources</h4>
                <ol>
                    <li>
                        <strong>Download a Release:</strong>
                        <p>
                            Visit the LKRG homepage at <a href="https://lkrg.org" target="_blank">lkrg.org</a> for
                            stable releases. To download and verify a release (e.g., v0.9.9), run:
                        </p>
                        <pre>
wget https://www.openwall.com/signatures/openwall-offline-signatures.asc
gpg --import openwall-offline-signatures.asc
wget https://lkrg.org/download/lkrg-0.9.9.tar.gz.sign
wget https://lkrg.org/download/lkrg-0.9.9.tar.gz
gpg --verify lkrg-0.9.9.tar.gz.sign lkrg-0.9.9.tar.gz</pre>
                    </li>
                    <li>
                        <strong>Clone the Development Repository:</strong>
                        <p>
                            For the latest development code, clone the LKRG repository from GitHub:
                        </p>
                        <pre>git clone https://github.com/lkrg-org/lkrg</pre>
                    </li>
                </ol>

                <h4>Build Requirements</h4>
                <p>
                    Ensure the following software is installed:
                </p>
                <ul>
                    <li>GNU make</li>
                    <li>GCC (ideally the same version used to build your kernel)</li>
                    <li>libelf development package (e.g., libelf-dev on Debian/Ubuntu or elfutils-libelf-devel on
                        RHEL-based systems)</li>
                    <li>Kernel headers corresponding to your running kernel (e.g.,
                        <code>linux-headers-$(uname -r)</code>)
                    </li>
                </ul>
                <p>
                    For example, on Debian/Ubuntu install dependencies with:
                </p>
                <pre>sudo apt-get install make gcc libelf-dev linux-headers-$(uname -r)</pre>

                <h4>Building LKRG</h4>
                <ol>
                    <li>
                        <strong>Compile the Module:</strong>
                        <p>
                            Navigate to the LKRG source directory and build using:
                        </p>
                        <pre>make -j$(nproc)</pre>
                        <p>
                            Building does not require root privileges.
                        </p>
                    </li>
                </ol>

                <h4>Testing LKRG</h4>
                <ol>
                    <li>
                        <strong>Load the Module Temporarily:</strong>
                        <p>
                            Test LKRG by inserting the module with enforcement enabled (which, by default, may trigger a
                            kernel panic on violations). To reduce risk during testing, you might use logging instead:
                        </p>
                        <pre>sudo insmod output/lkrg.ko kint_enforce=1</pre>
                    </li>
                    <li>
                        <strong>Monitor System Logs:</strong>
                        <p>
                            Check kernel messages to ensure LKRG is running without errors:
                        </p>
                        <pre>sudo dmesg</pre>
                    </li>
                    <li>
                        <strong>Unload the Module:</strong>
                        <p>
                            When testing is complete, unload LKRG with:
                        </p>
                        <pre>sudo rmmod lkrg</pre>
                    </li>
                </ol>

                <h4>Installation</h4>
                <ol>
                    <li>
                        <strong>Install LKRG Permanently:</strong>
                        <p>
                            If your distribution uses a supported init system (such as systemd or OpenRC), install LKRG
                            by running:
                        </p>
                        <pre>sudo make install</pre>
                    </li>
                    <li>
                        <strong>Start the LKRG Service:</strong>
                        <p>
                            For systemd-based systems:
                        </p>
                        <pre>sudo systemctl start lkrg</pre>
                        <p>
                            For OpenRC-based systems:
                        </p>
                        <pre>sudo /etc/init.d/lkrg start</pre>
                        <p>
                            Alternatively, load the module using:
                        </p>
                        <pre>sudo modprobe -v lkrg</pre>
                    </li>
                </ol>

                <h4>Autoload on Bootup</h4>
                <ol>
                    <li>
                        <strong>Systemd:</strong>
                        <pre>sudo systemctl enable lkrg</pre>
                    </li>
                    <li>
                        <strong>OpenRC:</strong>
                        <pre>sudo rc-update add lkrg boot</pre>
                    </li>
                    <li>
                        <strong>Other Init Systems:</strong>
                        <pre>
sudo mkdir -p /etc/modules-load.d/
echo lkrg | sudo tee /etc/modules-load.d/lkrg.conf</pre>
                    </li>
                </ol>

                <h4>Optional: Installing Using DKMS</h4>
                <ol>
                    <li>
                        <strong>Extract and Add LKRG:</strong>
                        <p>
                            On RHEL-based distributions, you can use DKMS for automatic rebuilds on kernel upgrades:
                        </p>
                        <pre>
sudo tar -xzf lkrg-0.9.9.tar.gz -C /usr/src/
sudo dkms add -m lkrg -v 0.9.9</pre>
                    </li>
                    <li>
                        <strong>Build and Install:</strong>
                        <pre>
sudo dkms build -m lkrg -v 0.9.9
sudo dkms install -m lkrg -v 0.9.9</pre>
                    </li>
                    <li>
                        <strong>Verify Installation:</strong>
                        <pre>dkms status</pre>
                    </li>
                </ol>

                <h4>Module Parameters and Configuration</h4>
                <p>
                    LKRG supports various module parameters to tune its behavior. To view them:
                </p>
                <pre>sudo modinfo lkrg</pre>
                <p>
                    Many parameters are also configurable at runtime via sysctl. For example, to list LKRG sysctls:
                </p>
                <pre>sudo sysctl -a | grep lkrg</pre>
                <p>
                    Refer to the LKRG documentation for detailed descriptions of each parameter and recommended
                    settings.
                </p>

                <h4>Uninstalling and Upgrading</h4>
                <ol>
                    <li>
                        <strong>Uninstalling:</strong>
                        <p>
                            If installed from source, run:
                        </p>
                        <pre>sudo make uninstall</pre>
                        <p>
                            If installed via DKMS, run:
                        </p>
                        <pre>sudo dkms remove -m lkrg/0.9.9 --all</pre>
                    </li>
                    <li>
                        <strong>Upgrading:</strong>
                        <p>
                            Uninstall the previous version before installing the new version, then repeat the build and
                            installation steps.
                        </p>
                    </li>
                </ol>

                <h4>Recovery Option</h4>
                <p>
                    In case LKRG causes system instability or prevents bootup, you can disable it temporarily by adding
                    the <code>nolkrg</code> kernel parameter to your bootloader’s command line. This will prevent LKRG
                    from loading, allowing you to boot and troubleshoot the system.
                </p>

                <p>
                    <em>For further details and the latest updates, please refer to the <a href="https://lkrg.org"
                            target="_blank">LKRG homepage</a>.</em>
                </p>
            </section>

            <section id="hardened-malloc">
                <h3>3.3 Hardened Malloc</h3>
                <p>Hardened Malloc is a memory allocator designed to detect and prevent memory corruption attacks. On
                    Linux distributions not based on Debian, you must compile Hardened Malloc from source. The following
                    steps explain how to download, verify, build, and install Hardened Malloc, as well as how to
                    configure your system and applications to use it.</p>

                <h4>Installation and Compilation</h4>
                <ol>
                    <li>
                        <strong>Update Package Lists:</strong>
                        <pre>sudo apt update</pre>
                        <p>This ensures you have the latest package information.</p>
                    </li>
                    <li>
                        <strong>Install Required Tools:</strong>
                        <pre>sudo apt install g++ git</pre>
                        <p>These packages are necessary for compiling the source code and cloning the repository.</p>
                    </li>
                    <li>
                        <strong>Download and Verify the Signing Key:</strong>
                        <p>Retrieve the signing key to later verify the source code signature:</p>
                        <pre>scurl-download https://github.com/thestinger.gpg</pre>
                        <p>Verify the key fingerprint:</p>
                        <pre>gpg --keyid-format long --with-fingerprint thestinger.gpg</pre>
                        <p>Expected fingerprint:</p>
                        <code>65EE FE02 2108 E2B7 08CB FCF7 F9E7 12E5 9AF5 F22A</code>
                        <p>Then import the key:</p>
                        <pre>gpg --import thestinger.gpg</pre>
                    </li>
                    <li>
                        <strong>Clone the Hardened Malloc Repository:</strong>
                        <pre>git clone https://github.com/GrapheneOS/hardened_malloc</pre>
                        <p>Navigate to the repository folder:</p>
                        <pre>cd hardened_malloc</pre>
                    </li>
                    <li>
                        <strong>Verify Software Signatures:</strong>
                        <p>Check the signature of the verified tag (here using tag "8"):</p>
                        <pre>git tag --verify 8</pre>
                        <p>Ensure the output shows a good signature from Daniel Micay, confirming authenticity.</p>
                    </li>
                    <li>
                        <strong>Checkout the Verified Tag:</strong>
                        <pre>git checkout 8</pre>
                    </li>
                    <li>
                        <strong>Build Hardened Malloc:</strong>
                        <pre>make</pre>
                        <p>This compiles the source code. The process should complete in a few seconds, depending on
                            your system.</p>
                    </li>
                    <li>
                        <strong>Install the Hardened Malloc Library:</strong>
                        <p>Create the destination directory and move the compiled library:</p>
                        <pre>
sudo mkdir -p /usr/lib/libhardened_malloc.so
sudo mv libhardened_malloc.so /usr/lib/x86_64-linux-gnu/libhardened_malloc.so</pre>
                    </li>
                    <li>
                        <strong>Set SUID on the Library:</strong>
                        <pre>sudo chmod u+s /lib/x86_64-linux-gnu/libhardened_malloc.so</pre>
                        <p>This grants the library the set-user-id permission.</p>
                    </li>
                    <li>
                        <strong>Installation Complete:</strong>
                        <p>Hardened Malloc is now installed on your system.</p>
                    </li>
                </ol>

                <h4>How to Launch Applications with Hardened Malloc</h4>
                <p>You can configure applications to use Hardened Malloc in several ways:</p>

                <h5>1. Launching Systemd Services</h5>
                <ol>
                    <li>
                        <strong>Create a Systemd Drop-in Configuration:</strong>
                        <p>Add the following line to your service's override configuration file to preload the Hardened
                            Malloc library:</p>
                        <pre>Environment="LD_PRELOAD=libhardened_malloc.so"</pre>
                    </li>
                </ol>

                <h5>2. Launching Individual Applications</h5>
                <ol>
                    <li>
                        <strong>Use the LD_PRELOAD Environment Variable:</strong>
                        <p>Start the desired application with the following command:</p>
                        <pre>LD_PRELOAD=libhardened_malloc.so application-name</pre>
                    </li>
                </ol>

                <h5>3. Setting Hardened Malloc for All Applications</h5>
                <ol>
                    <li>
                        <strong>Warning:</strong>
                        <p>This system-wide configuration may cause issues with applications such as <code>man</code>,
                            <code>apt</code>, or <code>Xorg</code>. Use with caution.
                        </p>
                    </li>
                    <li>
                        <strong>Edit the Preload Configuration File:</strong>
                        <p>Open <code>/etc/ld.so.preload</code> with root privileges:</p>
                        <pre>sudoedit /etc/ld.so.preload</pre>
                    </li>
                    <li>
                        <strong>Add the Hardened Malloc Library Path:</strong>
                        <p>Add the following line to the file:</p>
                        <pre>libhardened_malloc.so</pre>
                    </li>
                    <li>
                        <strong>Save and Close the File:</strong>
                        <p>The configuration is complete, and all applications will now use Hardened Malloc by default.
                        </p>
                    </li>
                </ol>

                <p>For further details, refer to the <a
                        href="https://www.kicksecure.com/wiki/Hardened_Malloc/Manual_Installation">Kicksecure Hardened
                        Malloc Manual</a>.</p>
            </section>

            <section id="linux-hardened-kernel">
                <h3>3.4 Linux-Hardened Kernel</h3>
                <p>The Linux-Hardened kernel includes additional security features. To install it on Arch Linux:</p>
                <ol>
                    <li><strong>Install the Kernel:</strong> Use the package manager to install the Linux-Hardened
                        kernel:
                        <pre>sudo pacman -S linux-hardened</pre>
                    </li>
                    <li><strong>Update Bootloader:</strong> Ensure your bootloader is configured to boot the new kernel.
                        For GRUB, update the configuration:
                        <pre>sudo grub-mkconfig -o /boot/grub/grub.cfg</pre>
                    </li>
                </ol>
            </section>

            <section id="kernel-module-blacklisting">
                <h3>3.5 Kernel Module Blacklisting</h3>
                <p>
                    Blacklisting unused or potentially vulnerable kernel modules reduces your system’s attack surface by
                    preventing their loading. Below is an example configuration that blacklists various unused network
                    protocols, filesystems, and drivers (such as those for FireWire, Thunderbolt, and framebuffer
                    devices) as well as explicitly disabling certain modules. This configuration can be added to a file
                    (e.g., <code>/etc/modprobe.d/blacklist.conf</code>) and then applied by updating your initramfs.
                </p>
                <p>
                    <strong>Example Blacklist Configuration:</strong>
                </p>
                <pre>
# Unused network protocols
install dccp /bin/false
install sctp /bin/false
install rds /bin/false
install tipc /bin/false
install n-hdlc /bin/false
install ax25 /bin/false
install netrom /bin/false
install x25 /bin/false
install rose /bin/false
install decnet /bin/false
install econet /bin/false
install af_802154 /bin/false
install ipx /bin/false
install appletalk /bin/false
install psnap /bin/false
install p8023 /bin/false
install p8022 /bin/false
install can /bin/false
install atm /bin/false

# FireWire and Thunderbolt support
install firewire-core /bin/false
install firewire_core /bin/false
install firewire-ohci /bin/false
install firewire_ohci /bin/false
install firewire_sbp2 /bin/false
install firewire-sbp2 /bin/false
install firewire-net /bin/false
install thunderbolt /bin/false
install ohci1394 /bin/false
install sbp2 /bin/false
install dv1394 /bin/false
install raw1394 /bin/false
install video1394 /bin/false

# Unused filesystems
install cramfs /bin/false
install freevxfs /bin/false
install jffs2 /bin/false
install hfs /bin/false
install hfsplus /bin/false
install squashfs /bin/false
install udf /bin/false
install cifs /bin/false
install nfs /bin/false
install nfsv3 /bin/false
install nfsv4 /bin/false
install ksmbd /bin/false
install gfs2 /bin/false
install reiserfs /bin/false
install kafs /bin/false
install orangefs /bin/false
install 9p /bin/false
install adfs /bin/false
install affs /bin/false
install afs /bin/false
install befs /bin/false
install ceph /bin/false
install coda /bin/false
install ecryptfs /bin/false
install erofs /bin/false
install jfs /bin/false
install minix /bin/false
install netfs /bin/false
install nilfs2 /bin/false
install ocfs2 /bin/false
install romfs /bin/false
install ubifs /bin/false
install zonefs /bin/false
install sysv /bin/false
install ufs /bin/false

# Disable vivid
install vivid /bin/false

# Disable GNSS modules
install gnss /bin/false
install gnss-mtk /bin/false
install gnss-serial /bin/false
install gnss-sirf /bin/false
install gnss-usb /bin/false
install gnss-ubx /bin/false

# Bluetooth modules
install bluetooth /bin/false
install btusb /bin/false

# Specific module blacklists
blacklist ath_pci

# Blacklist CD-ROM and related drivers
blacklist cdrom
blacklist sr_mod

# Framebuffer drivers blacklisting
blacklist cyber2000fb
blacklist cyblafb
blacklist gx1fb
blacklist hgafb
blacklist kyrofb
blacklist lxfb
blacklist matroxfb_base
blacklist neofb
blacklist nvidiafb
blacklist pm2fb
blacklist s1d13xxxfb
blacklist sisfb
blacklist tdfxfb
blacklist vesafb
blacklist vfb
blacklist vt8623fb
blacklist udlfb</pre>
                <p>
                    After saving the configuration, update your initramfs to apply the changes:
                </p>
                <pre>sudo update-initramfs -u</pre>
                <p>
                    This configuration helps ensure that unnecessary or legacy modules are not loaded, thereby reducing
                    potential vulnerabilities. For more details, refer to the source documentation <span
                        style="white-space:nowrap;">&#8203;:contentReference[oaicite:0]{index=0}</span>.
                </p>
            </section>

            <section id="sysctl-hardening">
                <h3>3.6 Sysctl Hardening</h3>
                <p>
                    Tuning sysctl parameters is essential to enhance kernel security by controlling network behavior,
                    system logging, and restricting potentially dangerous features. The following configuration includes
                    both standard hardening settings and additional parameters to prevent information leaks, mitigate
                    attacks, and enforce stricter access controls.
                </p>
                <ol>
                    <li>
                        <strong>Edit Sysctl Configuration:</strong>
                        <p>Open the sysctl configuration file (or create a dedicated hardening file, e.g.,
                            <code>/etc/sysctl.d/60-hardening.conf</code>):
                        </p>
                        <pre>sudo nano /etc/sysctl.d/60-hardening.conf</pre>
                    </li>
                    <li>
                        <strong>Add Security Parameters:</strong>
                        <p>Paste the following configuration into the file:</p>
                        <pre>
# Network Hardening
net.ipv4.conf.all.rp_filter = 1
net.ipv4.conf.default.rp_filter = 1
net.ipv4.conf.*.send_redirects = 0
net.ipv4.conf.*.accept_redirects = 0
net.ipv6.conf.*.accept_redirects = 0
net.ipv6.conf.all.use_tempaddr = 2
net.ipv6.conf.default.use_tempaddr = 2
net.ipv4.conf.all.log_martians = 1
net.ipv4.conf.default.log_martians = 1

# BPF and Kernel Debug Restrictions
net.core.bpf_jit_harden = 2
kernel.yama.ptrace_scope = 3
kernel.unprivileged_bpf_disabled = 1

# Limit Kernel Exposure
kernel.sysrq = 0
kernel.perf_event_paranoid = 3
kernel.kptr_restrict = 2
kernel.dmesg_restrict = 1

# Filesystem and Process Hardening
fs.binfmt_misc.status = 0
fs.suid_dumpable = 0
fs.protected_regular = 2
fs.protected_fifos = 2
dev.tty.ldisc_autoload = 0

# Restrict userfaultfd usage
vm.unprivileged_userfaultfd = 0

# Console and kexec Protection
kernel.printk = 3 3 3 3
kernel.kexec_load_disabled = 1

# Disable Core Dumps and io_uring
kernel.core_pattern = |/bin/false
kernel.io_uring_disabled = 2

# Enhance ASLR for mmap
vm.mmap_rnd_bits = 32
vm.mmap_rnd_compat_bits = 16</pre>
                    </li>
                    <li>
                        <strong>Apply Changes:</strong>
                        <p>Reload the sysctl settings to make the new configuration active:</p>
                        <pre>sudo sysctl --system</pre>
                    </li>
                </ol>
                <p>
                    These sysctl parameters help mitigate a variety of attack vectors by enforcing stricter network
                    controls, reducing kernel information leakage, disabling insecure debugging interfaces, and
                    improving randomization for memory allocations. For more details, please refer to the source
                    documentation at <a
                        href="https://github.com/secureblue/secureblue/blob/live/files/system/etc/sysctl.d/60-hardening.conf"
                        target="_blank">SecureBlue's hardening config</a>.
                </p>
            </section>
        </section>

        <section id="attack-surface-reduction">
            <h2>4. Attack Surface Reduction</h2>

        </section>

        <section id="software-security">
            <h2>5. Security and Authenticity of Software Updates</h2>

        </section>

        <section id="network-security">
            <h2>6. Network Security</h2>

        </section>
    </main>
</body>

</html>